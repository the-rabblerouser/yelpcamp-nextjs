{"ast":null,"code":"import { connectToDatabase } from '../../../utils/mongodb';\n\nlet ObjectID = require('mongodb').ObjectID;\n\nexport default (async (req, res) => {\n  const {\n    db\n  } = await connectToDatabase();\n  const {\n    query: {\n      id\n    },\n    method\n  } = req;\n\n  switch (method) {\n    case 'GET':\n      try {\n        const campground = await db.collection('campgrounds').find({\n          _id: new ObjectID(id)\n        }).toArray();\n        res.json(campground);\n      } catch (error) {\n        res.status(400).json({\n          success: false\n        });\n      }\n\n      break;\n\n    case 'PUT':\n      try {\n        console.log(req.body);\n        const campground = await db.collection('campgrounds').findOneAndUpdate({\n          _id: req.body._id\n        }, {\n          $set: {\n            title: req.body.title,\n            location: req.body.location\n          }\n        }, {\n          new: true\n        });\n        res.json(campground);\n      } catch (error) {\n        res.status(400).json({\n          success: false\n        });\n      }\n\n      break;\n\n    default:\n      res.setHeader('Allow', ['GET', 'PUT']);\n      res.status(405).end(`Method ${method} Not Allowed`);\n  }\n});","map":{"version":3,"sources":["/Users/joemccann/Desktop/yelpcamp-nexjs/pages/api/campground/[id].js"],"names":["connectToDatabase","ObjectID","require","req","res","db","query","id","method","campground","collection","find","_id","toArray","json","error","status","success","console","log","body","findOneAndUpdate","$set","title","location","new","setHeader","end"],"mappings":"AAAA,SAASA,iBAAT,QAAkC,wBAAlC;;AAEA,IAAIC,QAAQ,GAAGC,OAAO,CAAC,SAAD,CAAP,CAAmBD,QAAlC;;AAEA,gBAAe,OAAOE,GAAP,EAAYC,GAAZ,KAAoB;AAClC,QAAM;AAAEC,IAAAA;AAAF,MAAS,MAAML,iBAAiB,EAAtC;AACA,QAAM;AACLM,IAAAA,KAAK,EAAE;AAAEC,MAAAA;AAAF,KADF;AAELC,IAAAA;AAFK,MAGFL,GAHJ;;AAKA,UAAQK,MAAR;AACC,SAAK,KAAL;AACC,UAAI;AACH,cAAMC,UAAU,GAAG,MAAMJ,EAAE,CACzBK,UADuB,CACZ,aADY,EAEvBC,IAFuB,CAElB;AAAEC,UAAAA,GAAG,EAAE,IAAIX,QAAJ,CAAaM,EAAb;AAAP,SAFkB,EAGvBM,OAHuB,EAAzB;AAKAT,QAAAA,GAAG,CAACU,IAAJ,CAASL,UAAT;AACA,OAPD,CAOE,OAAOM,KAAP,EAAc;AACfX,QAAAA,GAAG,CAACY,MAAJ,CAAW,GAAX,EAAgBF,IAAhB,CAAqB;AAAEG,UAAAA,OAAO,EAAE;AAAX,SAArB;AACA;;AAED;;AACD,SAAK,KAAL;AACC,UAAI;AACHC,QAAAA,OAAO,CAACC,GAAR,CAAYhB,GAAG,CAACiB,IAAhB;AACA,cAAMX,UAAU,GAAG,MAAMJ,EAAE,CAACK,UAAH,CAAc,aAAd,EAA6BW,gBAA7B,CACxB;AAAET,UAAAA,GAAG,EAAET,GAAG,CAACiB,IAAJ,CAASR;AAAhB,SADwB,EAExB;AAAEU,UAAAA,IAAI,EAAE;AAAEC,YAAAA,KAAK,EAAEpB,GAAG,CAACiB,IAAJ,CAASG,KAAlB;AAAyBC,YAAAA,QAAQ,EAAErB,GAAG,CAACiB,IAAJ,CAASI;AAA5C;AAAR,SAFwB,EAGxB;AACCC,UAAAA,GAAG,EAAE;AADN,SAHwB,CAAzB;AAQArB,QAAAA,GAAG,CAACU,IAAJ,CAASL,UAAT;AACA,OAXD,CAWE,OAAOM,KAAP,EAAc;AACfX,QAAAA,GAAG,CAACY,MAAJ,CAAW,GAAX,EAAgBF,IAAhB,CAAqB;AAAEG,UAAAA,OAAO,EAAE;AAAX,SAArB;AACA;;AACD;;AACD;AACCb,MAAAA,GAAG,CAACsB,SAAJ,CAAc,OAAd,EAAuB,CAAC,KAAD,EAAQ,KAAR,CAAvB;AACAtB,MAAAA,GAAG,CAACY,MAAJ,CAAW,GAAX,EAAgBW,GAAhB,CAAqB,UAASnB,MAAO,cAArC;AAhCF;AAkCA,CAzCD","sourcesContent":["import { connectToDatabase } from '../../../utils/mongodb';\n\nlet ObjectID = require('mongodb').ObjectID;\n\nexport default async (req, res) => {\n\tconst { db } = await connectToDatabase();\n\tconst {\n\t\tquery: { id },\n\t\tmethod,\n\t} = req;\n\n\tswitch (method) {\n\t\tcase 'GET':\n\t\t\ttry {\n\t\t\t\tconst campground = await db\n\t\t\t\t\t.collection('campgrounds')\n\t\t\t\t\t.find({ _id: new ObjectID(id) })\n\t\t\t\t\t.toArray();\n\n\t\t\t\tres.json(campground);\n\t\t\t} catch (error) {\n\t\t\t\tres.status(400).json({ success: false });\n\t\t\t}\n\n\t\t\tbreak;\n\t\tcase 'PUT':\n\t\t\ttry {\n\t\t\t\tconsole.log(req.body);\n\t\t\t\tconst campground = await db.collection('campgrounds').findOneAndUpdate(\n\t\t\t\t\t{ _id: req.body._id },\n\t\t\t\t\t{ $set: { title: req.body.title, location: req.body.location } },\n\t\t\t\t\t{\n\t\t\t\t\t\tnew: true,\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\tres.json(campground);\n\t\t\t} catch (error) {\n\t\t\t\tres.status(400).json({ success: false });\n\t\t\t}\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tres.setHeader('Allow', ['GET', 'PUT']);\n\t\t\tres.status(405).end(`Method ${method} Not Allowed`);\n\t}\n};\n"]},"metadata":{},"sourceType":"module"}